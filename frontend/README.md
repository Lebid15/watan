This is a [Next.js](https://nextjs.org) project bootstrapped with [`create-next-app`](https://nextjs.org/docs/app/api-reference/cli/create-next-app).

## Getting Started

### Backend dependency

> **New:** the frontend now talks to the Django sidecar that lives in `djangoo/` under the prefix `/api-dj/**`.

1. ุฏุงุฎู ูุฌูุฏ `djangoo/` ูุนูู ุงูุจูุฆุฉ ูุดุบูู ุงูุฎุงุฏู:
	```powershell
	cd ..\djangoo
	python -m venv .venv
	.\.venv\Scripts\Activate.ps1
	pip install -r requirements.txt
	python manage.py migrate
	python manage.py runserver 0.0.0.0:8000
	```
2. ุชุฃูุฏ ูู ุฃู ุงููุชุบูุฑ `NEXT_PUBLIC_API_URL` (ุฃู ุงูุงูุชุฑุงุถู ุงูุฌุฏูุฏ) ูุดูุฑ ุฅูู `http://127.0.0.1:8000/api-dj`.
	- ููุฅุจูุงุก ุนูู ุงูุจุงู ุฅูุฏ ุงููุฏูู (NestJS) ููููู ุถุจุท `NEXT_PUBLIC_USE_OLD_BACKEND=true` ูู `.env.local`.

ุจุนุฏ ุชุดุบูู ุงูู backend ูููู ุจุฏุก ุฎุงุฏู Next.js:
First, run the development server:

```bash
npm run dev
# or
yarn dev
# or
pnpm dev
# or
bun dev
```

Open [http://localhost:3000](http://localhost:3000) with your browser to see the result.

You can start editing the page by modifying `app/page.tsx`. The page auto-updates as you edit the file.

This project uses [`next/font`](https://nextjs.org/docs/app/building-your-application/optimizing/fonts) to automatically optimize and load [Geist](https://vercel.com/font), a new font family for Vercel.

## Learn More

To learn more about Next.js, take a look at the following resources:


You can check out [the Next.js GitHub repository](https://github.com/vercel/next.js) - your feedback and contributions are welcome!

## Deploy on Vercel

The easiest way to deploy your Next.js app is to use the [Vercel Platform](https://vercel.com/new?utm_medium=default-template&filter=next.js&utm_source=create-next-app&utm_campaign=create-next-app-readme) from the creators of Next.js.

Check out our [Next.js deployment documentation](https://nextjs.org/docs/app/building-your-application/deploying) for more details.

### Unit Pricing (Admin UI)

ูุฐู ุงููุงุฌูุฉ ุชุชูุญ ุชุณุนูุฑ ุงูููุชุฌุงุช ุจูุถุน "ุนุฏุงุฏ" (ูุญุฏุงุช) ุจุงูุฅุถุงูุฉ ุฅูู ุงูุชุณุนูุฑ ุงูุซุงุจุช.

1. ุงูุชูุนูู: ูู ุตูุญุฉ `Admin > Products` ุงุณุชุฎุฏู ุฒุฑ ุงูุชุญููู (Counter / Fixed) ููู ููุชุฌ.
2. ุฅุนุฏุงุฏุงุช ุงููุญุฏุฉ: ุฏุงุฎู ุตูุญุฉ ุงูููุชุฌ ูุธูุฑ ุชุจููุจ "ุฅุนุฏุงุฏุงุช ุงูุนุฏุงุฏ" ุนูุฏูุง ูููู ุงูููุชุฌ ููุนูููุง ูุจู ุจุงูุงุช ููุนูุง `unit`.
	- ุงูุญููู: `unitName`, `unitCode`, `minUnits`, `maxUnits`, `step`.
3. ุณุนุฑ ุงููุญุฏุฉ ููู ูุฌููุนุฉ ุฃุณุนุงุฑ: ูู ุตูุญุฉ `Admin > Products > Price Groups` ูุธูุฑ ุนููุฏ "Unit price" ููุจุงูุงุช ุฐุงุช ุงูููุน `unit` ููุท.
	- ุฅุฏุฎุงู ูููุฉ ููุฌุจุฉ ุจุนุฏุฏ ุงูููุงุฒู ุงูุนุดุฑูุฉ ุงููุนุชูุฏ (`NEXT_PUBLIC_PRICE_DECIMALS`).
	- ุญูุธ (โ) ููุดุฆ Override ุนุจุฑ: `PUT /api/admin/price-groups/:groupId/package-prices/:packageId/unit`.
	- ุญุฐู (ร) ูุนูุฏ ุงููููุฉ ุงูุฃุณุงุณูุฉ ุนุจุฑ: `DELETE /api/admin/price-groups/:groupId/package-prices/:packageId/unit`.
	- ูุชู ุฌูุจ ุงูุญุงูุฉ ุงูุญุงููุฉ ุจุนุฏ ูู ุนูููุฉ: `GET /api/admin/products/price-groups/:groupId/package-prices?packageId=...`.
4. ุงูุฏูุฉ (Precision): ุชุญุฏุฏ ูู ุงููุชุบูุฑ `NEXT_PUBLIC_PRICE_DECIMALS` (ุงูุชุฑุงุถู 2ุ ููููู ุถุจุทู ูู 3). ุฌููุน ุงูุญููู ุชุญุชุฑู ูุฐู ุงูุฏูุฉ (step ุฏููุงูููู 0.01 ุฃู 0.001).
5. ุงูุจุงูุงุช ุฐุงุช ุงูููุน `fixed` ุชุนุฑุถ ุดุฑุทุฉ (โ) ูู ุนููุฏ Unit price ููุง ุชุชุฃุซุฑ.
6. ุฑุณุงุฆู ุงูุชูููุฑ: ูุฌุงุญ ุงูุญูุธ "ุชู ุญูุธ ุณุนุฑ ุงููุญุฏุฉ."ุ ุญุฐู ุงูุชุฎุตูุต "ุชู ุญุฐู ุงูุชุฎุตูุต."ุ ููู ุงููุดู ุชูุนุฑุถ ุฑุณุงูุฉ ุงูุณูุฑูุฑ.

ูุนุงููุฑ ุงููุจูู (ูุฎุชุตุฑุฉ):
- ุฅูุดุงุก ูุญุฐู ุงูู override ููุนูุณุงู ููุฑูุง ุจุนุฏ ุฌูุจ ุงูุชุญุฏูุซ.
- ุงูุชุญูู ูููุน ุงูููู ุบูุฑ ุงูุตุงูุญุฉ (โค0 ุฃู ุตูุบุฉ ุฎุงุทุฆุฉ) ูุจู ุงูุฅุฑุณุงู.
- ูุง ุชุฃุซูุฑ ุนูู ุงูุจุงูุงุช ุงูุซุงุจุชุฉ.

### ุดุฑุงุก ุจุงูุนุฏุงุฏ (Storefront)

ุชุธูุฑ ุจุทุงูุฉ "ุงูุดุฑุงุก ุจุงูุนุฏุงุฏ" ูู ุตูุญุฉ ุงูููุชุฌ (`/product/[id]`) ููุท ุฅุฐุง:
1. ุงูููุชุฌ ููุนูู ูู `supportsCounter`.
2. ุชูุฌุฏ ุนูู ุงูุฃูู ุจุงูุฉ ูุงุญุฏุฉ ููุนูุง `unit` ูููุนููุฉ.

ุงูููููู ูุนุฑุถ:
- ุงุฎุชูุงุฑ ุงูุจุงูุฉ (ุฅู ููุฌุฏ ุฃูุซุฑ ูู ุจุงูุฉ ูุญุฏุงุช).
- ุญูู ุงููููุฉ ูุน ูููุฏ: ุงูุญุฏ ุงูุฃุฏูู `minUnits`ุ ุงูุญุฏ ุงูุฃูุตู `maxUnits`ุ ูุงูุฎุทูุฉ `step` (ุฃู ูุณุชูุชุฌุฉ ูู `NEXT_PUBLIC_PRICE_DECIMALS`).
- ุงูุณุนุฑ ุงูููุฑู: (ุณุนุฑ ุงููุญุฏุฉ ุงููุนูุงู ร ุงููููุฉ) ููุญุฏููุซ ูุจุงุดุฑุฉ ููุณุชุฎุฏู ุงูุฏูุฉ ุงููุนุชูุฏุฉ.

ูุตุฏุฑ ุณุนุฑ ุงููุญุฏุฉ ุงููุนูุงู:
1. ูุญุงููุฉ ุฌูุจ ุณุนุฑ ุงููุฌููุนุฉ (override) ุนุจุฑ endpoint ูุฑู ููุจู ุนุฏุฉ ุฃุดูุงู:
	- `{ price: number }` ุฃู `{ unitPrice: number }`
	- ูุตูููุฉ: `[ { packageId, price }, ... ]`
	- ูุงุฆู: `{ data: [ { packageId, price }, ... ] }`
2. ุนูุฏ ุงููุดู ุฃู ุนุฏู ุงูุนุซูุฑ ุนูู ุตู ููุณุนุฑ ูุชู ุฅุฑุฌุงุน `null` ูููุนุฑุถ "โ" ูู ุงููุงุฌูุฉุ ููุง ููุฌุฏ Fallback.

ุงูุชุญูู (Client Side):
- ูููุน: ูููุฉ ูุงุฑุบุฉุ ุบูุฑ ุฑูููุฉุ โค 0ุ ุฃูู ูู ุงูุญุฏ ุงูุฃุฏููุ ุฃูุจุฑ ูู ุงูุญุฏ ุงูุฃูุตูุ ุฃู ูุง ุชุทุงุจู ุฎุทูุฉ ุงูุฒูุงุฏุฉ (ูุน ุชุณุงูุญ ุนุงุฆู ุตุบูุฑ 1e-9).
- ูู ุญุงู ุงูุฎุทุฃ: ูุธูุฑ ูุต ุชุญุฐูุฑ ูููุนุทููู ุฒุฑ ุงูุดุฑุงุก.

ุงูุฅุฑุณุงู:
- `POST /api/orders` ูุน: `{ productId, packageId, quantity }` ููุท (ูุง ูุฑุณู ุณุนุฑ ุงููุญุฏุฉ ูุชุฌููุจ ุงูุชูุงุนุจุ ุงูุชูููู ุงูููุงุฆู ูุฏู ุงูุฎุงุฏู).
- ูุฌุงุญ: Toast + ุชูุฑูุบ ุญูู ุงููููุฉ + ุฅุนุงุฏุฉ ุชูุฌูู ุฅูู `/orders/:id` ุฅู ุชููุฑ `id` ุฃู `/orders`.
- ูุดู: ุนุฑุถ ุฑุณุงูุฉ ุงูุณูุฑูุฑ ููุง ุฌุงุกุช (ูุซูุงู ุฃููุงุฏ `ERR_*`).

ููุงุญุธุงุช:
- ุฏูุฉ ุงูุฃุณุนุงุฑ ุชุชุญูู ุจูุง `NEXT_PUBLIC_PRICE_DECIMALS` (ูุซูุงู 2 โ step = 0.01ุ 3 โ 0.001) ุฅุฐุง ูู ุชูุฏูู ุงูุจุงูุฉ ุฎุทูุฉ ุตุฑูุญุฉ.
- ุงูุญุณุงุจ ุงููุนุฑูุถ ุฅุฑุดุงุฏูุ ุงูุชุณุนูุฑ ุงูุญุงุณู ููุญุณุจ ูู ุงูุฎูููุฉ.

#### Redirect Behavior

ุนูุฏ ูุฌุงุญ ุงูุทูุจ:
- ุฅุฐุง ุงุญุชูู ุงูุฑุฏ ุนูู `order.id` โ ุงูุงูุชูุงู ุฅูู `/orders/{id}`.
- ุฅู ูู ูููููุฑ `id` โ ุงูุงูุชูุงู ุฅูู `/orders`.

ูุถุจุท ุณููู ูุฎุตุต (ูุชุญ Modalุ ุฃู ุฅุจูุงุก ุงููุณุชุฎุฏู ุจุงูุตูุญุฉ): ููู ุงุณุชุฏุนุงุก `POST /api/orders` ุถูู ุฏุงูุฉ ุฎุงุฑุฌูุฉ ููุฑุฑ `onSuccess / onError` ูู Props ููููููู ุจุฏู ุงูุงุนุชูุงุฏ ุนูู ุงูุชูุฌูู ุงููุฏูุฌ.

#### Troubleshooting

1. ุชุบููุฑ ุดูู ุฑุฏู ุณุนุฑ ุงููุญุฏุฉ:
	- ุงููุงุฑุช ูุฏุนู ุงูุตูุบ: `{ price }`ุ `{ unitPrice }`ุ ูุตูููุฉ ูุจุงุดุฑุฉุ ุฃู `{ data: [...] }`.
	- ุงููุดู ุฃู ุนุฏู ูุฌูุฏ ุตู โ ุงููุชูุฌุฉ `null` (ุนุฑุถ ุดุฑุทุฉ) ุจุฏูู ุฃู Fallback.
	- ูุชุนุฏูู ุงูุณููู ุนุฏูู ููุท ุฏุงูุฉ ุงูุฌูุจ `fetchUnitPrice`.

2. ุฃุฎุทุงุก "STEP / MIN / MAX" ูู ุงูุณูุฑูุฑ:
	- ุชุฃูุฏ ุฃู ุงูุฅุฏุฎุงู ูุทุงุจู `step` ูุงูุฏูุฉ (`NEXT_PUBLIC_PRICE_DECIMALS`).
	- ุงุนุฑุถ ุฑุณุงูุฉ ุงูุณูุฑูุฑ ููุง ูู ูุชุฌููุจ ุงุฎุชูุงู ุงูุชุฑุฌูุฉ ุฃู ุงูุชุถููู.

3. ุงูุณุนุฑ ูุธูุฑ โ:
	- ุชุญููู ูู: ุชูุนูู `supportsCounter`ุ ุงูุจุงูุฉ ููุนูุง `unit`ุ ููุฌูุฏ ุตู ุณุนุฑ ูููุฌููุนุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช.

4. ุงุณุชุฏุนุงุกุงู ูุชุชุงููุงู ูู fetch:
	- ูุชููุน: ุงูุฃูู ูุฌูุจ ุณุนุฑ ุงููุญุฏุฉ (override)ุ ุงูุซุงูู ูุฅูุดุงุก ุงูุทูุจ.
	- ูููู ุฏูุฌู ูุงุญููุง ุฅุฐุง ูููุฑ Endpoint ููุญูุฏ.

5. ุงูุจุทุงูุฉ ูุง ุชุธูุฑ:
	- ุงูุดุฑุทุงู: `supportsCounter === true` ููุฌูุฏ ุจุงูุฉ ูุงุญุฏุฉ ุนูู ุงูุฃูู `type === 'unit'` ููุนููุฉ.

6. ูุดู ููุงุฌุฆ ุจุนุฏ ูุฌุงุญ ุงูุชุญูู ุงููุญูู:
	- ุงูุชูููู ุงูููุงุฆู (ุงูุณุนุฑุ ุงูุญุฏูุฏ) ููุนุงุฏ ุงูุชุญูู ููู ูู ุงูุณูุฑูุฑุ ุฑุงุฌุน ุฑุณุงูุฉ ุงูุฎุทุฃ ุงููุนุงุฏุฉ ูุงุจุญุซ ุนู ุชุญุฏูุซุงุช ุญุตูุช ูู `minUnits`/`maxUnits` ุฃุซูุงุก ุชูุงุนู ุงููุณุชุฎุฏู.


## ๐ ุชุนุฏุฏ ุงููุบุงุช (Arabic / English / Turkish)

ุชู ุฅุถุงูุฉ ุฏุนู ุชุนุฏุฏ ุงููุบุงุช ุนุจุฑ ุชุญููู ุฏููุงูููู ููููุงุช JSON ูู `public/locales`.

### ุงููุบุงุช ุงููุฏุนููุฉ
| Code | ุงููุบุฉ |
|------|-------|
| ar   | ุงูุนุฑุจูุฉ (ุงูุชุฑุงุถู) |
| en   | English |
| tr   | Tรผrkรงe |

### ุฃูู ุชูุฌุฏ ูููุงุช ุงูุชุฑุฌูุฉุ
```
public/locales/
	ar/common.json
	en/common.json
	tr/common.json
```
ูุณุชุฎุฏู ุญุงูููุง ูุณุงุญุฉ ุฃุณูุงุก ูุงุญุฏุฉ: `common`.

### ุฅุถุงูุฉ ููุชุงุญ ุชุฑุฌูุฉ ุฌุฏูุฏ
1. ุฃุถู ุงูููุชุงุญ ุฅูู `ar/common.json` (ูุตุฏุฑ ุงูุญูููุฉ ุงูุฃููู).
2. ุงูุณุฎ ููุณ ุงูููุชุงุญ ุฅูู `en/common.json` ู `tr/common.json` ูุน ุงูููู ุงููุชุฑุฌูุฉ.
3. ุงุณุชุฎุฏูู ูู ุงูููุฏ ุนุจุฑ:
```tsx
import i18n from '@/i18n/client';
const t = (k: string) => (i18n.getResource(i18n.language || 'ar', 'common', k) as string) || k;
...
<span>{t('some.key')}</span>
```

### ูุจุฏู ุงููุบุฉ
ุงูููููู: `src/components/LanguageSwitcher.tsx`
ููุนุฑุถ ูู:
- ุงูููุฏุฑ ุงูุฑุฆูุณู (`MainHeader`)
- ุตูุญุงุช ุจุฏูู ููุฏุฑ (ูุซู ุชุณุฌูู ุงูุฏุฎูู) ูู ุฃุนูู ูููู ุงูุตูุญุฉ.

### ููู ูุชู ุชุญุฏูุฏ ุงููุบุฉ ุนูุฏ ุงูุชุญูููุ
1. Cookie ุจุงุณู `NEXT_LOCALE` ุฅู ููุฌุฏ.
2. ุซู `localStorage.locale`.
3. ูุฅูุง fallback ุฅูู `ar`.

ูุชู ุถุจุท:
- `document.documentElement.lang`
- `document.documentElement.dir` (ูููุฉ `rtl` ููุท ููู `ar`).

### ุงูุชุจุฏูู ุจูู ุงููุบุงุช
ูููุฐ:
- `setLocale(code)` ูู `src/i18n/client.ts`:
	- ุชุบููุฑ ูุบุฉ i18next.
	- ุชุฎุฒูู ูู LocalStorage + Cookie.
	- ุชุญุฏูุซ ุงูุฎุตุงุฆุต `lang` ู `dir`.

### ุฅุถุงูุฉ ูุบุฉ ุฌุฏูุฏุฉ (ูุซุงู: ุงูุฃููุงููุฉ de)
1. ุฃูุดุฆ ูุฌูุฏ: `public/locales/de`.
2. ุงูุณุฎ `ar/common.json` ุฅูู `de/common.json` ูุชุฑุฌู ุงููุญุชูู.
3. ุนุฏูู ูุตูููุฉ `supportedLngs` ูู `src/i18n/client.ts`.
4. ุฃุถู ุงูููุฏ ุฅูู ูุตูููุฉ `langs` ุฏุงุฎู `LanguageSwitcher`.
5. (ุงุฎุชูุงุฑู) ุงุฌุนููุง ุงูุงูุชุฑุงุถูุฉ ุจุชุบููุฑ `lng` ู `fallbackLng`.

### ููุงุญุธุงุช ุชูููุฉ
- ูุง ูุณุชุฎุฏู ุญุงูููุง `next-i18next` ุงููุงูู ูุนุฏู ุงูุญุงุฌุฉ ุฅูู ุชุฑุฌูุฉ ุนูู ูุณุชูู ุงูุฎุงุฏู SSR ููู ุตูุญุฉ.
- ุงูุชุญููู ุฏููุงูููู (lazy)ุ ุฃูู ุนุฑุถ ูุฏ ูุธูุฑ ููุงุชูุญ ุฎุงู ุญุชู ูุชู ุฌูุจ ุงูููู (ุนุงุฏุฉู ุณุฑูุน ุฌุฏูุง ุฏุงุฎู ููุณ origin).
- ูููู ูุงุญููุง ุงูุชูุณุน ูุฏุนู namespaces ูุชุนุฏุฏุฉ (ูุซูุงู `auth`, `cart`).

### ุงุนุชุจุงุฑุงุช RTL
- ูุชู ุชุทุจูู `dir=rtl` ุนุงููููุง ููุท ุนูุฏ ุงููุบุฉ ุงูุนุฑุจูุฉ.
- ุชุฃูุฏ ุฃู ุงูููููุงุช ุงููุฑูุฉ Flex ูุง ุชุนุชูุฏ ุนูู `ml-*` ุจุฏูู ูุฑุงุนุงุฉ ุงูุงุชุฌุงู ุนูุฏ ุฅุถุงูุฉ ูุบุงุช LTR.

### ูุดุงูู ุดุงุฆุนุฉ
| ุงููุดููุฉ | ุงูุณุจุจ | ุงูุญู |
|---------|-------|------|
| ูุธูุฑ ุงูููุชุงุญ ููุณู ุจุฏู ุงูุชุฑุฌูุฉ | ูู ููุญููู ุงูููู ุจุนุฏ | ุชุฃูุฏ ูู ุงุณุชุฏุนุงุก `loadNamespace` ุฃู ุงูุชุธุฑ ุฏูุฑุฉ ุฅุนุงุฏุฉ ุงูุฑุณู |
| ุงูุงุชุฌุงู ูู ูุชุบูุฑ | ุนูุตุฑ `<html>` ูู ููุญุฏูุซ | ูุญุฏุซ ุนูุฏ ุงูุชุจุฏูู ูุจู ุชููุฆุฉ i18nุ ุฃุนุฏ ุงููุญุงููุฉ ุจุนุฏ ุซูุงู | 
| ูุบุฉ ุชุนูุฏ ููุนุฑุจูุฉ ุจุนุฏ ุชุญุฏูุซ ุงูุตูุญุฉ | Cookie / LocalStorage ูุญุฌูุจุฉ | ูุนูู ุงูุชุฎุฒูู ุฃู ุงุณุชุฎุฏู ูุชุตูุญ ูุฎุชูู |

### ุงุฎุชุจุงุฑ ุณุฑูุน
1. ุงูุชุญ `/login`.
2. ุจุฏูู ุงููุบุฉ ูู ุงูุฒุงููุฉ ุงูุนูููุฉ.
3. ุชุฃูุฏ ูู ุชุฑุฌูุฉ:
	 - ุงูุนููุงู
	 - ูุงุจู ุงูุจุฑูุฏ
	 - ุฒุฑ ุงูุฏุฎูู
4. ุฃุนุฏ ุงูุชุญููู (Refresh) ูุชุญูู ูู ุจูุงุก ุงููุบุฉ ุงููุฎุชุงุฑุฉ.


