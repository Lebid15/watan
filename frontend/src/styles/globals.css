@tailwind base;
@tailwind components;
@tailwind utilities;

/* ================== جذور الألوان لكل الثيمات ================== */

/* الوضع الفاتح الافتراضي + عند وجود data-theme="light" */
:root,
:root[data-theme="light"] {
  /* خلفيات دافئة برتقالية/بيج */
  --color-bg-base: 255 249 244;        /* لون الشات الخلفي */
  --color-bg-surface: 255 255 255;     /* البانل الأبيض */
  --color-bg-surface-alt: 255 236 220; /* فقاعة الرسائل المستلمة */

  /* النصوص */
  --color-text-primary: 45 36 26;      /* #2d241a */
  --color-text-secondary: 107 96 87;   /* #6b6057 */

  /* الحدود */
  --color-border: 248 221 200;         /* لون الفاصل */

  /* الألوان الرئيسية */
  --color-primary: 255 188 120;        /* فقاعة الرسائل المرسلة */
  --color-primary-hover: 255 176 102;
  --color-primary-active: 255 164 84;
  --color-primary-contrast: 45 36 26;  /* نص داكن على خلفية فاتحة */

  --color-success: 34 197 94;
  --color-warning: 181 83 9;           /* #b45309 */
  --color-danger: 239 68 68;

  --color-bg-input: 255 255 255;
}

/* Dark 1 */
:root[data-theme="dark1"] {
  --color-bg-base: 17 24 39;
  --color-bg-surface: 31 41 55;
  --color-bg-surface-alt: 55 65 81;

  --color-text-primary: 255 255 255;
  --color-text-secondary: 209 213 219;

  --color-border: 75 85 99;

  --color-primary: 230 175 46;
  --color-primary-hover: 209 158 41;
  --color-primary-active: 187 142 38;
  --color-primary-contrast: 0 0 0;

  --color-success: 34 197 94;
  --color-warning: 245 158 11;
  --color-danger: 239 68 68;

  --color-bg-input: 34 37 46;
}

/* Dark 2 */
:root[data-theme="dark2"] {
  --color-bg-base: 15 23 42;
  --color-bg-surface: 30 41 59;
  --color-bg-surface-alt: 51 65 85;

  --color-text-primary: 255 255 255;
  --color-text-secondary: 203 213 225;

  --color-border: 71 85 105;

  --color-primary: 230 175 46;
  --color-primary-hover: 209 158 41;
  --color-primary-active: 187 142 38;
  --color-primary-contrast: 0 0 0;

  --color-success: 34 197 94;
  --color-warning: 245 158 11;
  --color-danger: 239 68 68;

  --color-bg-input: 34 37 46;
}

/* Dark 3 */
:root[data-theme="dark3"] {
  --color-bg-base: 0 0 0;
  --color-bg-surface: 24 24 27;
  --color-bg-surface-alt: 39 39 42;

  --color-text-primary: 255 255 255;
  --color-text-secondary: 212 212 216;

  --color-border: 63 63 70;

  --color-primary: 230 175 46;
  --color-primary-hover: 209 158 41;
  --color-primary-active: 187 142 38;
  --color-primary-contrast: 0 0 0;

  --color-success: 34 197 94;
  --color-warning: 245 158 11;
  --color-danger: 239 68 68;

  --color-bg-input: 34 37 46;
}

/* Dark 4 - WhatsApp Dark Mode */
:root[data-theme="dark4"] {
  /* خلفيات WhatsApp الداكنة */
  --color-bg-base: 11 20 26;           /* خلفية الشات الرئيسية */
  --color-bg-surface: 17 27 33;        /* البانل/الكارد */
  --color-bg-surface-alt: 32 44 51;    /* فقاعة الرسائل المستلمة */

  /* النصوص */
  --color-text-primary: 226 232 240;   /* #e2e8f0 */
  --color-text-secondary: 158 148 141; /* #9e948d */

  /* الحدود */
  --color-border: 35 49 56;            /* لون الفاصل */

  /* الألوان الرئيسية */
  --color-primary: 0 92 75;            /* فقاعة الرسائل المرسلة - WhatsApp green */
  --color-primary-hover: 0 106 86;
  --color-primary-active: 0 120 97;
  --color-primary-contrast: 226 232 240; /* نص فاتح */

  /* نجاح/تحذير/خطر */
  --color-success: 34 197 94;
  --color-warning: 245 158 11;
  --color-danger: 239 68 68;

  /* حقول الإدخال */
  --color-bg-input: 32 44 51;
}

/* ================== ألوان Tailwind مخصصة ================== */
@layer base {
  body {
    @apply text-[rgb(var(--color-text-primary))];
    margin: 0;
    font-family: Arial, sans-serif;
  }
  
  /* Gradient للثيم الفاتح - تدرج برتقالي دافئ */
  :root body,
  :root[data-theme="light"] body {
    background: linear-gradient(135deg, #ffe8d6 0%, #fff2e6 50%, #fff9f4 100%);
    background-attachment: fixed;
  }
  
  /* Gradient للثيم الداكن 1 - تدرج رمادي غامق */
  :root[data-theme="dark1"] body {
    background: linear-gradient(135deg, #242e3a 0%, #1a2532 50%, #111827 100%);
    background-attachment: fixed;
  }
  
  /* Gradient للثيم الداكن 2 - تدرج أزرق داكن */
  :root[data-theme="dark2"] body {
    background: linear-gradient(135deg, #1e293b 0%, #172033 50%, #0f172a 100%);
    background-attachment: fixed;
  }
  
  /* Gradient للثيم الداكن 3 - تدرج أسود نقي */
  :root[data-theme="dark3"] body {
    background: linear-gradient(135deg, #1a1a1d 0%, #0f0f10 50%, #000000 100%);
    background-attachment: fixed;
  }
  
  /* Gradient للثيم dark4 - WhatsApp Dark مع تدرج أخضر */
  :root[data-theme="dark4"] body {
    background: linear-gradient(135deg, #0d1f1a 0%, #0c1a17 50%, #0b141a 100%);
    background-attachment: fixed;
  }
  
  /* عند تفعيل عرض نسخة الديسكتوب مصغرة على الموبايل */
  body.desktop-fixed-no-scroll {
    overflow: hidden; /* منع أي سكرول خارجي */
    touch-action: none; /* تقليل التمرير العرضي */
  }
}

/* ================== Dark Shims ================== */
:root[data-theme="dark1"] .text-gray-700,
:root[data-theme="dark2"] .text-gray-700,
:root[data-theme="dark3"] .text-gray-700 { color: rgb(var(--color-text-primary)) !important; }

:root[data-theme="dark1"] .text-gray-500,
:root[data-theme="dark2"] .text-gray-500,
:root[data-theme="dark3"] .text-gray-500 { color: rgb(var(--color-text-secondary)) !important; }

:root[data-theme="dark1"] .border-gray-200,
:root[data-theme="dark2"] .border-gray-200,
:root[data-theme="dark3"] .border-gray-200 { border-color: rgb(var(--color-border)) !important; }

:root[data-theme="dark1"] .bg-gray-50,
:root[data-theme="dark2"] .bg-gray-50,
:root[data-theme="dark3"] .bg-gray-50 { background-color: rgb(var(--color-bg-surface-alt)) !important; }

:root[data-theme="dark1"] .shadow,
:root[data-theme="dark2"] .shadow,
:root[data-theme="dark3"] .shadow { box-shadow: 0 1px 2px rgba(0,0,0,.25), 0 4px 10px rgba(0,0,0,.18) !important; }

/* ================== Components ================== */
@layer components {
  /* بطاقات */
  .card {
    @apply bg-[rgb(var(--color-bg-surface))] border border-[rgb(var(--color-border))] rounded-xl;
  }

  /* إدخالات */
  .input {
    /* ✅ أصبحت تستخدم bg-input حتى تتبدّل حسب الثيم */
    @apply bg-[rgb(var(--color-bg-input))] text-[rgb(var(--color-text-primary))] border border-[rgb(var(--color-border))] rounded-md px-3 py-2 outline-none;
  }
  .input::placeholder { color: rgb(var(--color-text-secondary)); }
  .input:focus {
    @apply border-[rgb(var(--color-primary))];
    box-shadow: 0 0 0 3px rgba(var(--color-primary) / .18);
  }
  .input:disabled {
    opacity: .7;
    cursor: not-allowed;
  }

  /* أزرار */
  .btn {
    @apply inline-flex items-center justify-center gap-2 rounded-md px-3 py-2 font-medium transition;
    border: 1px solid rgba(var(--color-border) / 1);
  }

  .btn-primary {
    background-color: rgb(var(--color-primary));
    color: rgb(var(--color-primary-contrast));
    border-color: rgba(var(--color-primary) / .4);
  }
  .btn-primary:hover { background-color: rgb(var(--color-primary-hover)); }
  .btn-primary:active { background-color: rgb(var(--color-primary-active)); }

  .btn-secondary {
    @apply bg-[rgb(var(--color-bg-surface))] text-[rgb(var(--color-text-primary))];
  }
  .btn-secondary:hover { background-color: rgba(var(--color-primary) / .08); }

  .btn-ghost {
    @apply bg-transparent text-[rgb(var(--color-text-primary))];
    border-color: transparent;
  }
  .btn-ghost:hover { background-color: rgba(var(--color-primary) / .08); }

  /* شارات */
  .badge { @apply inline-flex items-center gap-2 rounded-full px-2 py-1 text-xs; }
  .badge-success { background-color: rgba(var(--color-success) / .15); color: rgb(var(--color-success)); }
  .badge-warning { background-color: rgba(var(--color-warning) / .15); color: rgb(var(--color-warning)); }
  .badge-danger  { background-color: rgba(var(--color-danger)  / .15); color: rgb(var(--color-danger));  }

  /* جداول */
  .table-wrap { @apply overflow-auto rounded-lg border border-[rgb(var(--color-border))]; }
  .table {
    @apply min-w-full text-sm;
  }
  .table thead { @apply bg-[rgb(var(--color-bg-surface-alt))] text-[rgb(var(--color-text-primary))]; }
  .table thead tr { @apply border-b border-[rgb(var(--color-border))]; }
  .table thead th { @apply px-3 py-2 font-semibold text-right; }

  .table tbody { @apply divide-y divide-[rgb(var(--color-border))]; }
  .table tbody tr:nth-child(odd) { @apply bg-[rgb(var(--color-bg-surface))]; }
  .table tbody tr:nth-child(even){ @apply bg-[rgb(var(--color-bg-surface))]; }
  .table tbody td { @apply px-3 py-2 align-middle; }

  /* قوائم منسدلة عامة (تستخدمها الـ Dropdowns) */
  .menu {
    background-color: rgb(var(--color-bg-surface));
    border: 1px solid rgb(var(--color-border));
    border-radius: 0.5rem;
    box-shadow: 0 10px 15px rgba(0,0,0,.10), 0 4px 6px rgba(0,0,0,.05);
  }
}

/* إخفاء زر/مبدّل الثيم في الشاشات الصغيرة */
@media (max-width: 768px) {
  .theme-toggle-btn,
  .theme-toggle-floating {
    display: none !important;
  }
}

/* ================== تنسيق Scrollbar المخصص ================== */
.custom-scrollbar {
  scrollbar-width: auto; /* Firefox - عريض */
  scrollbar-color: rgba(100, 116, 139, 0.5) transparent; /* Firefox: thumb track */
}

/* WebKit (Chrome, Safari, Edge) */
.custom-scrollbar::-webkit-scrollbar {
  width: 16px;
  height: 16px;
}

.custom-scrollbar::-webkit-scrollbar-track {
  background: rgba(148, 163, 184, 0.1);
  border-radius: 10px;
}

.custom-scrollbar::-webkit-scrollbar-thumb {
  background: linear-gradient(180deg, rgba(100, 116, 139, 0.6), rgba(71, 85, 105, 0.7));
  border-radius: 10px;
  border: 2px solid transparent;
  background-clip: padding-box;
  transition: background 0.3s ease;
}

.custom-scrollbar::-webkit-scrollbar-thumb:hover {
  background: linear-gradient(180deg, rgba(71, 85, 105, 0.8), rgba(51, 65, 85, 0.9));
}

.custom-scrollbar::-webkit-scrollbar-thumb:active {
  background: linear-gradient(180deg, rgba(51, 65, 85, 1), rgba(30, 41, 59, 1));
}

/* زاوية الـ scrollbar (عند تقاطع الأفقي والعمودي) */
.custom-scrollbar::-webkit-scrollbar-corner {
  background: transparent;
}
