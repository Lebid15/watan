{% extends "admin/change_list.html" %}
{% block content %}
  <div class="card">
    <div class="card-header"><h2>وضع الصيانة</h2></div>
    <div class="card-body">
      {% if messages %}
        {% for message in messages %}
          <div class="alert alert-{{ message.tags }}">{{ message }}</div>
        {% endfor %}
      {% endif %}
      <form method="post" action="{% url 'admin:devtools-maintenance-apply' %}">
        {% csrf_token %}
        <div class="form-group">
          <label for="id_message">رسالة الصيانة:</label>
          {{ maint_form.message }}
        </div>
        <div class="form-group">
          <label for="id_enabled">تفعيل وضع الصيانة:</label>
          {{ maint_form.enabled }}
        </div>
        <div class="mt-3" style="display:flex; gap:8px; flex-wrap:wrap;">
          {% if maint_enabled %}
            <button type="submit" name="action" value="disable" class="btn btn-danger">تعطيل وضع الصيانة</button>
          {% else %}
            <button type="submit" name="action" value="enable" class="btn btn-success">تفعيل وضع الصيانة</button>
          {% endif %}
        </div>
        {% if maint_message %}
          <div class="text-muted mt-2">الحالة الحالية: {{ maint_enabled|yesno:"مفعّل,متوقف" }}</div>
          <div class="border rounded p-2 bg-light mt-2" style="white-space:pre-wrap;">{{ maint_message }}</div>
        {% endif %}
      </form>
    </div>
  </div>
{% endblock %}
